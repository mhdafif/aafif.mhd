---
import Layout from "@/components/Layout/Layout.astro";
import { Icon } from "astro-icon/components";
import blogsData from "@/data/blogs.json";

const blogs = blogsData.sort(
  (a, b) =>
    new Date(b.publishedAt).getTime() - new Date(a.publishedAt).getTime()
);
const featuredBlogs = blogs.filter((blog) => blog.featured);
const otherBlogs = blogs.filter((blog) => !blog.featured);
---

<Layout>
  <main class="bg-blacki z-2 min-h-screen">
    <!-- Header -->
    <header class="bg-charcoal border-off-white/10 border-b">
      <div class="mx-auto max-w-6xl px-6 py-12">
        <nav class="mb-6">
          <a
            href="/"
            class="text-star hover:text-star/80 flex items-center gap-2 text-sm font-medium transition-colors"
          >
            <Icon name="ic:baseline-arrow-back" class="h-4 w-4" />
            Back to Home
          </a>
        </nav>

        <div class="text-center">
          <h1 class="text-off-white mb-4 text-4xl font-bold">
            Blog & Articles
          </h1>
          <p class="text-off-white/70 mx-auto max-w-2xl text-xl">
            Thoughts, insights, and experiences from my journey as a software
            developer. Sharing knowledge about web development, best practices,
            and the latest technologies.
          </p>
        </div>
      </div>
    </header>

    <!-- Content -->
    <div class="mx-auto max-w-6xl px-6 py-12">
      <!-- Featured Articles -->
      {
        featuredBlogs.length > 0 && (
          <section class="mb-16">
            <h2 class="text-star mb-8 flex items-center gap-2 text-2xl font-bold">
              <Icon name="ic:baseline-star" class="h-6 w-6" />
              Featured Articles
            </h2>
            <div class="grid grid-cols-1 gap-8 lg:grid-cols-2">
              {featuredBlogs.map((blog) => (
                <article class="blog-card featured bg-charcoal border-off-white/10 hover:border-star/30 group rounded-xl border p-8 transition-all duration-300">
                  <div class="mb-4 flex items-start justify-between">
                    <div class="text-off-white/60 flex items-center gap-2 text-sm">
                      <time datetime={blog.publishedAt}>
                        {new Date(blog.publishedAt).toLocaleDateString(
                          "en-US",
                          {
                            year: "numeric",
                            month: "long",
                            day: "numeric",
                          }
                        )}
                      </time>
                      <span>•</span>
                      <span>{blog.readTime}</span>
                    </div>
                    <span class="bg-star/20 text-star rounded-full px-3 py-1 text-xs font-medium">
                      Featured
                    </span>
                  </div>

                  <h3 class="text-off-white group-hover:text-star mb-4 text-2xl font-bold transition-colors">
                    <a href={`/blog/${blog.slug}`} class="hover:underline">
                      {blog.title}
                    </a>
                  </h3>

                  <p class="text-off-white/80 mb-6 line-clamp-3">
                    {blog.excerpt}
                  </p>

                  <div class="flex items-center justify-between">
                    <div class="flex flex-wrap gap-2">
                      {blog.tags.slice(0, 3).map((tag) => (
                        <span class="bg-blacki text-off-white/70 rounded-full px-3 py-1 text-sm">
                          {tag}
                        </span>
                      ))}
                    </div>

                    <a
                      href={`/blog/${blog.slug}`}
                      class="text-star hover:text-star/80 flex items-center gap-2 font-medium transition-colors"
                    >
                      Read article
                      <Icon name="ic:baseline-arrow-forward" class="h-4 w-4" />
                    </a>
                  </div>
                </article>
              ))}
            </div>
          </section>
        )
      }

      <!-- All Articles -->
      <section>
        <h2 class="text-star mb-8 flex items-center gap-2 text-2xl font-bold">
          <Icon name="ic:baseline-article" class="h-6 w-6" />
          All Articles
        </h2>
        <div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
          {
            blogs.map((blog) => (
              <article class="blog-card bg-charcoal/70 border-off-white/5 hover:border-off-white/20 hover:bg-charcoal group rounded-lg border p-6 transition-all duration-300">
                <div class="mb-3 flex items-center justify-between">
                  <div class="text-off-white/60 flex items-center gap-2 text-sm">
                    <time datetime={blog.publishedAt}>
                      {new Date(blog.publishedAt).toLocaleDateString("en-US", {
                        year: "numeric",
                        month: "short",
                        day: "numeric",
                      })}
                    </time>
                    <span>•</span>
                    <span>{blog.readTime}</span>
                  </div>
                  {blog.featured && (
                    <Icon name="ic:baseline-star" class="text-star h-4 w-4" />
                  )}
                </div>

                <h3 class="text-off-white group-hover:text-star mb-3 line-clamp-2 text-lg font-semibold transition-colors">
                  <a href={`/blog/${blog.slug}`} class="hover:underline">
                    {blog.title}
                  </a>
                </h3>

                <p class="text-off-white/70 mb-4 line-clamp-3 text-sm">
                  {blog.excerpt}
                </p>

                <div class="flex items-center justify-between">
                  <div class="flex flex-wrap gap-1">
                    {blog.tags.slice(0, 2).map((tag) => (
                      <span class="bg-blacki text-off-white/60 rounded px-2 py-1 text-xs">
                        {tag}
                      </span>
                    ))}
                  </div>

                  <a
                    href={`/blog/${blog.slug}`}
                    class="text-star hover:text-star/80 flex items-center gap-1 text-sm transition-colors"
                  >
                    Read
                    <Icon name="ic:baseline-arrow-forward" class="h-3 w-3" />
                  </a>
                </div>
              </article>
            ))
          }
        </div>
      </section>
    </div>
  </main>
</Layout>

<style>
  .blog-card {
    &.featured {
      position: relative;

      &::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--color-star), transparent);
        border-radius: 12px 12px 0 0;
      }
    }

    .line-clamp-2 {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .line-clamp-3 {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    a {
      text-decoration: none;
    }

    &:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
    }
  }

  .blog-card h3 a {
    color: inherit;
    transition: color 0.3s ease;
  }
</style>
